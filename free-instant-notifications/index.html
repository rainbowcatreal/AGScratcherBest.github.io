<!DOCTYPE html>
<html>
  <head>
    <title>Бесплатные подписки на мгновенные уведомления</title>
    <script src="https://code.jquery.com/jquery-3.6.4.min.js"></script>
  </head>
  <body>
    <p>Введите адрес форума:</p>
    <input id="address">
    <button id="submit">Готово</button>
    <script>
      $('#submit').on('click', function() {
        let forum = $('#address').val();
        let time = $;

        $.get(location.protocol + "//" + b.forum + "/api.php", {
          method: "board.get",
          fields: "board_id"
        }, function() {
    // Генерируем confirm (примерная реализация - замените на вашу логику)
    const generateConfirm = () => {
        const timestamp = Math.floor(Date.now() / (1000 * 3600 * 24));
        const dataToHash = `${forum}%${1}%${timestamp}`;
        // В реальном коде используйте вашу функцию sha1
        return 'xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx'; // 40 символов
    };

    // Формируем URL для перенаправления
    const redirectUrl = new URL('https://notifications.mybb.ru');
    
    // Добавляем обязательные параметры
    redirectUrl.searchParams.append('forum', forum);
    redirectUrl.searchParams.append('option', '1'); // Фиксированная опция 1 (Бессрочно)
    redirectUrl.searchParams.append('confirm', generateConfirm());
    
    // Добавляем timestamp для предотвращения кеширования
    redirectUrl.searchParams.append('_', Date.now());

    // Перенаправляем
    console.log('Перенаправление на:', redirectUrl.toString());
    window.location.href = redirectUrl.toString();
        }), 'json');
    </script>
  </body>
</html>
